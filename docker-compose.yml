# SPDX-FileCopyrightText: 2025 The superseedr Contributors
# SPDX-License-Identifier: GPL-3.0-or-later

services:
  # ==========================================
  # PLUGINS
  # ==========================================
  
  superseedr-rss:
    build: ./plugins/RSS/superseedr-rss
    container_name: superseedr-rss
    profiles: ["rss"]
    ports:
      - "${RSS_PORT:-19554}:3000"
    volumes:
      - ${HOST_SUPERSEEDR_SHARE_PATH:-superseedr-share}:/superseedr-share
      - rss-data:/data
    environment:
      - WATCH_DIR=/superseedr-share/watch_files
      - STATUS_DIR=/superseedr-share/status_files
      - DATA_DIR=/data
      - PORT=3000
    restart: unless-stopped

  # ------------------------------------------

  superseedr-notifications:
    build: ./plugins/Notifications/superseedr-notifications
    container_name: superseedr-notifications
    profiles: ["notifications"]
    ports:
      - "${NOTIFICATIONS_PORT:-19555}:5000"
    volumes:
      - ${HOST_SUPERSEEDR_SHARE_PATH:-superseedr-share}:/superseedr-share:ro
      - notifications-data:/data
    environment:
      - STATUS_FILE=/superseedr-share/status_files/app_state.json
      - DATA_DIR=/data
      - PORT=5000
    restart: unless-stopped

  # ------------------------------------------

  superseedr-webui-backend:
    build: ./plugins/WebUI/superseedr-webui/backend
    container_name: superseedr-webui-backend
    profiles: ["webui"]
    ports:
      - "${WEBUI_BACKEND_PORT:-19556}:8080"
    volumes:
      - ${HOST_SUPERSEEDR_SHARE_PATH:-superseedr-share}:/superseedr-share
    environment:
      - STATUS_FILE=/superseedr-share/status_files/app_state.json
      - WATCH_DIR=/superseedr-share/watch_files
      - PORT=8080
    restart: unless-stopped

  superseedr-webui-frontend:
    build: 
      context: ./plugins/WebUI/superseedr-webui/frontend
      args:
        - VITE_API_URL=http://localhost:19556/api/stats
    container_name: superseedr-webui-frontend
    profiles: ["webui"]
    ports:
      - "${WEBUI_PORT:-19557}:80"
    restart: unless-stopped

volumes:
  superseedr-share:
  rss-data:
  notifications-data:
